# TODO Snapshot (2025-10-30)

- [ ] Create/complete SQL migrations for RBAC gateway expansions (017 and enums ok)
- [ ] Implement repositories: project_data, access conditions, institutions (InstitutionRepositoryImpl pending)
- [ ] Combined RBAC evaluator: finalize priority/inheritance edge cases, caching
- [ ] Map access_condition to QIDO params and JSON paths (base done; extend tags/operators)
- [ ] Rule caching and DB indices from design
- [ ] Settings: finalize dcm4chee settings; sync-only/api-only modes validated in prod
- [ ] Unit tests: evaluator priority/inheritance stubs â†’ concrete; gateway integration
- [ ] API docs: update with /instances and RBAC filtering details (baseline added)
- [ ] Re-enable legacy tests progressively; performance/external tests with #[ignore]
- [ ] Seed data or run sync, then run index benchmark and report results
- [ ] Refactor ignored doctests into runnable/no_run async examples and re-enable
- [ ] Reduce compiler warnings (unused code/imports) across controllers/services

---

## í•œ ëˆˆì— ë³´ëŠ” ì§„í–‰ ìƒíƒœ

âœ… ì™„ë£Œ
- RBAC ìŠ¤í‚¤ë§ˆ í™•ì¥: project_data_study/series/instance ì¶”ê°€, ê´€ê³„ ëª¨ë¸(UIDâ†”study_id/series_id) êµ¬ì¶•, ë£°/ì—°ê³„ í…Œì´ë¸”(security_*_dicom_condition) ì¶”ê°€
- ë™ê¸°í™” ì—”ì§„: ìŠ¤ì¼€ì¤„ëŸ¬/ì›Œì»¤ êµ¬í˜„, ë¸íƒ€ ë™ê¸°í™”(updated_time), ë§¤í•‘(Study/Series/Instance), ì¸í„°ë²Œ í™˜ê²½ì„¤ì •(SERVER_MODE/sync.interval)
- DICOM ê²Œì´íŠ¸ì›¨ì´: /api/dicom/studies|series|instances êµ¬í˜„, Keycloak í† í° ë¦´ë ˆì´, evaluator ê¸°ë°˜ ì‚¬í›„ í•„í„°ë§
- RBAC evaluator: í”„ë¡œì íŠ¸ ë©¤ë²„ì‹­/ëª…ì‹œì  ê¶Œí•œ/ê·œì¹™ ê¸°ë°˜ í‰ê°€ ë¡œì§, ë‹¨ìœ„í…ŒìŠ¤íŠ¸
- í…ŒìŠ¤íŠ¸ ì•ˆì •í™”: ë ˆê±°ì‹œ ë¹„í™œì„±í™” ë° í•„ìš”í•œ ê³³ #[ignore], í˜„ì¬ ì „ì²´ ê·¸ë¦° ìœ ì§€
- ì„œë²„ ëª¨ë“œ/ì„¤ì •: full/api-only/sync-only, Dcm4chee DB ì„¤ì • ê²½ë¡œ ì¶”ê°€

ğŸŸ¡ ë¶€ë¶„ ì™„ë£Œ
- ì¸ë±ìŠ¤ ìµœì í™”: í•µì‹¬ ì¸ë±ìŠ¤ ì„¤ê³„/DDL ë¯¸ì ìš©
- ì •ì±… ì—°ë™ ì‹¬í™”: ë£°/ìš°ì„ ìˆœìœ„/ì—­í• -í”„ë¡œì íŠ¸ ë³‘í•©ì€ êµ¬í˜„í–ˆìœ¼ë‚˜ ì „ ë²”ìœ„ ê²€ì¦/ë¬¸ì„œí™” ë¯¸í¡
- QIDO í•„í„°/í˜ì´ì§€ë„¤ì´ì…˜: Modality/PatientID/StudyDate ì¼ë¶€ ë§¤í•‘ë§Œ ì ìš©, í˜ì´ì§€ë„¤ì´ì…˜ ë¯¸êµ¬í˜„
- ë¡œê¹…/ë©”íŠ¸ë¦­: ë¡œê·¸ëŠ” ìˆìŒ, ë©”íŠ¸ë¦­/ëŒ€ì‹œë³´ë“œ ì—†ìŒ

â›” ë¯¸ì™„ë£Œ
- RBAC ìì²´ DICOMweb API(/dicomweb/studies/series/instances) â€” dcm4chee ë¹„ì˜ì¡´ DB ê¸°ë°˜ ì œê³µ
- í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™(í—ˆìš© ë°ì´í„°ë§Œ ë Œë”, ì—­í• ë³„ UI ì œì–´, ì—ëŸ¬ UX)
- dcm4chee ì´ë²¤íŠ¸ í›… ê¸°ë°˜ ì‹¤ì‹œê°„ ë™ê¸°í™”(Webhook/Retry/Queue)
- ëª¨ë‹ˆí„°ë§/ì•Œë¦¼(Prometheus/Grafana/Slack ë“±)

ì¶”ê°€ ë©”ëª¨
- ë™ê¸°í™” DB í¬íŠ¸ëŠ” ì‹¤í–‰ ì‹œ í™˜ê²½ë³€ìˆ˜ë¡œ ì„¤ì • ê°€ëŠ¥í•˜ë©°, ê¸°ì¡´ ì„¸ì…˜ í¬íŠ¸ ì¶©ëŒë¡œ ì„œë²„ê°€ ë°”ë¡œ ì¢…ë£Œëœ ì¼€ì´ìŠ¤ê°€ ìˆì—ˆìŠµë‹ˆë‹¤(8080 ì ìœ ). í•„ìš” ì‹œ ê¸°ì¡´ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ í›„ ì¬ì‹¤í–‰í•˜ë©´ ë©ë‹ˆë‹¤.
